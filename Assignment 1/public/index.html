<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="Part A.css">
    <title>Assignment 1</title>

    <script src = "./Product_info.js">
        
    </script>
</head>

<body>
    <center>
    <header>
        <img id = headerpic src = ./Images/header.jpg>
    </header>
    <main>
       
        <form name = "product_display" method = "POST" action = "./purchase">
            <table>
              
                <script>
                    //Loop to display products, discription and quantity text box
                    for (i = 0; i < products_array.length; i++) {
                        document.write(`
                <tr>
                <div id = productbox> 
                <td><img src= ./Images/${(products_array[i].image)} width = 200px height =200px></td> 
                <td id = description><h2>${(products_array[i].package)} - $${(products_array[i].price)}</h2> 
                <p>${(products_array[i].description)}</p></td> 
                <td>Enter a Quantity:<br> <input type = "text" name = "${(products_array[i].package)}" onkeyup="checkQuantityTextbox(this);"><br><span id='qty_textbox_message'>Dont Leave Blank<span></td>
                </div>
                </tr>
        `);
                    };
                </script>

</table>
<div id = "submit">
<input type = "submit" name = "submit" value = "Submit Order">
</div>
            
        </form>
    </main> 
</center>
</body>

</html>


<Script>

    function isNonNegInt(q, return_errors = false) {
    errors = []; // assume no errors at first
    if (Number(q) != q) errors.push('Not a number!'); // Check if string is a number value
    if (q < 0) errors.push('Negative value!'); // Check if it is non-negative
    if (parseInt(q) != q) errors.push('Not an integer!'); // Check that it is an integer
    return return_errors ? errors : (errors.length == 0);
}

//Need to figure out way to get proper name of text box into function instead quantity_textbox
// Create an array of the names of each textbox
names_array = [];

for (i = 0; i < products_array.length; i++) {
    names_array.push(products_array[i].package);
}

console.log(names_array);

//Use loop to input and check errors for each specific textbox so client side knows what theyre doing wrong. They can still submit bad data and the server will also tell them what to fix.
function checkQuantityTextbox() {
    for (i = 0; i < products_array.length; i++) {
            errs_array = isNonNegInt(names_array[i].value, true);
            qty_textbox_message.innerHTML = errs_array.join(',');
        }
};

/*
let params = (new URL(document.location)).searchParams;
        GET = {};
        params.forEach(function (value, key) { GET[key] = value });
        if (typeof GET['quantity_textbox'] != 'undefined') {
            displayPurchase();
            window.stop();
        }
        */
</Script>
