<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="Part A.css">
    <title>Assignment 1</title>

    <script src = "./Product_info.js">
        
    </script>
</head>

<body>
    <center>
    <header>
        <img id = headerpic src = ./Images/header.jpg>
    </header>
    <main>
       
        <form name = "product_display" method = "POST" action = "./purchase">
            <table>
              
                <script>
                    //Loop to display products, discription and quantity text box
                    for (i = 0; i < products_array.length; i++) {
                        document.write(`
                <tr>
                <div id = productbox> 
                <td><img src= ./Images/${(products_array[i].image)} width = 200px height =200px></td> 
                <td id = description><h2>${(products_array[i].package)} - $${(products_array[i].price)}</h2> 
                <p>${(products_array[i].description)}</p></td> 
                <td><p><label for = "quantity_textbox">Quantity:</label> <br> <input type = text name = "${(products_array[i].package)}"><p></td>
                </div>
                </tr>
        `);
                    };
                </script>

</table>
<div id = "submit">
<input type = "submit" name = "submit" value = "Submit Order">
</div>
            
        </form>
    </main> 
</center>
</body>

</html>


<Script>
  let params = (new URL(document.location)).searchParams;
  var quantities = [];
  // form was submitted so process the invoice
  if (params.has('purchase_submit')) {
    for (i = 0; i < products.length; i++) {
      if (params.has(`quantity${i}`)) {
        a_qty = params.get(`quantity${i}`);
        quantities[i] = a_qty;
      }
    }
  } else {
    document.write('no form submitted');
  }
  console.log(quantities);

function DisplayPurchase(POST, response) {
    q = POST['quantity_textbox'];
    if (isNonNegInt(q)) {
        response.send(`Thank you for purchasing ${q} things!`);
    }
    else { response.send(`${q} is not a quantity! Press the back button and try again.`);}
function isNonNegInt(q, return_errors = false) {
    errors = []; // assume no errors at first
    if (Number(q) != q) errors.push('Not a number!'); // Check if string is a number value
    if (q < 0) errors.push('Negative value!'); // Check if it is non-negative
    if (parseInt(q) != q) errors.push('Not an integer!'); // Check that it is an integer
    return return_errors ? errors : (errors.length == 0);
}

function checkQuantityTextbox() {
            errs_array = isNonNegInt(quantity_textbox.value, true)
            qty_textbox_message.innerHTML = errs_array.join(',')
        }


}

let params = (new URL(document.location)).searchParams;
        GET = {};
        params.forEach(function (value, key) { GET[key] = value });
        if (typeof GET['quantity_textbox'] != 'undefined') {
            displayPurchase();
            window.stop();
        }
</Script>
